# Beehive框架：用于对企业网中可疑活动检测的大规模日志分析

## 概述

随着越来越多的基于网络的攻击出现，公司组织通过部署各种各样的安全产品来应对，这些安全产品以日志的形式生成情景智能。这些日志通常包含大量的有用和有趣的（令人关注的 ==interesting==）关于网络活动的信息，并且是信息安全专家在怀疑发生了攻击时首先咨询的数据源之一。然而，安全产品往往来自于各个不同的供应商，并不能够得到一致的安装和管理。它们生成的日志在格式上千差万别，并且在容量上往往是不完整的、互相矛盾的。因此，尽管收集到的这些信息是有用的，但他们通常被视作脏数据。

​        我们介绍一个新的系统，**Beehive**,它能够解决大型企业中各种安全产品产生的脏日志数据的自动挖掘和提取知识的问题。

​       我们对基于以检测安全事件为方法的签名加以改进，而不是识别可疑的主机行为，这些主机行为被**Beehive**视作潜在的安全事件。然后，这些事件可以被事件响应小组进一步分析，来判断是否发生了违反政策或者攻击事件。我们对Beehive在大型企业EMC中收集的日志数据进行了为期两周的评估。

我们将由**Beehive** 识别的事件和企业安全操作中心的报告、 以及抗病毒软件的警告和来自于企业安全专家的反馈进行了比较。我们发现**Beehive**是有能力辨认恶意行为和可能未被检测到的违规行为的，否则这些行为将不会被发现。

- improve on 对什么加一改进
- an assortment of  各种类别的
- an approach to doing sth 做某事的方法
- malicious code 恶意代码

## 1. 介绍

​       在一个大型公司或组织中，计算机的基础设施保护是一个日渐重要的挑战。一般的恶意软件和定向攻击（例如：高级持续性威胁（APTs））正变得越来越复杂，能力超过了类似于杀毒软件这样传统的抵御系统。与此同时，随着员工越来越多地将个人设备用于业务应用程序，管理员对主机的状态和行为的可见性正在下降。此外，由于商业知识共享、承包商的关系、地理位置分布的新的复杂性出现等原因，组织（公司）的传统框架正在逐渐崩溃。

​       许多公司组织正在通过部署各种各样的安全产品来应对这一挑战（challenging product），而这些安全产品是以安全日志的形式进行策略实施并生成场景智能的。这些安全产品代理web流量，检测恶感染软件、==策略冲突==，实施有效的==认证机制==，并且执行许多其他有用的安全功能。

​       这些产品生成的日志包含高容量、受关注的有关网络活动的有用信息，是安全专家在发现攻击时首先要查看的数据源之一。例如，认证日志可能会表明一个用户的账户已经被攻破（==compromised==），因为登录来自于目标用户从未访问过的区域。另一个例子，web代理日志可能会记录受害者访问的站点，然后才会受到网络挂马攻击（Drive-By Download）。

（自己的注解：==Drive-By Download==是一种网络攻击手段，国内称为“网站挂马攻击”。Drive-By Download是当今最流行的恶意软件传播手段，它主要是综合大量的已知漏洞(也可能包括未知漏洞)对用户的浏览器发起攻击。

​        尽管通过日志来分析检测可疑的网络活动是一种标准通用做法，但这种检测往往还是手工操作并且依赖于一些*==已知的威胁的签名==*。一个主要的挑战是安全产品往往来自于许多不同供应商（零件拼凑而成），不能得到一致的管理和安装。他们产生的日志数据在格式上有很大的区别，日志往往是不完整的、自相矛盾、容量很大（例如，大型企业中与安全相关的日志每天增长TB）并且充满了非特定的或是伪造的事件记录。因此，尽管收集到的信息是有用的，而且有时是手边唯一的信息，但同时它往往也是脏数据。

​      在本文中，我们针对大型企业中各种安全产品产生的脏数据的自动挖掘和提取问题。 我们的目标是改进基于签名检测安全事件的方法，而不是对主机可疑活动进行检测，这些活动标志着潜在的安全事件的存在。这些事件可以被事件响应小组用来进一步分析，以判断是否发生了策略违反冲突或者攻击。我们方法中的一个关键点就是，在大型企业环境观察到的行为往往比那些在开放的网络上的更加受政策和典型员工的约束。因此，我们可以通过分析企业特有的行为来识别可疑活动。

​       我们的自动化方法，称作Beehive，有三层。（1）使用特定的网络配置信息去解析、过滤和规范化日志数据的功能;（2）特征生成器：对规范化数据进行处理，每天对每个主机生成一组15个不同的；（3）对特征进行聚类以识别主机活动的可疑期的检测器，系统将其报告为事件。 

​       我们用了超过两周的时间来测试运行Beehive，其中测试的日志数据来源于大型企业EMC。我们将Beehive自动化识别的事件与企业安全操作中心的报道、反病毒软件警报以及来自于公司安全专家的反馈做了比较。我们发现，Beehive在一个企业网络中能够辨认大量的恶意事件，包括恶意软件感染、策略冲突，否则现有的最先进的安全工具和人员就会忽略这些事件。

 我们的工作贡献如下：

- 我们提出了一个新奇的自动化方法叫做Beehive ，它分析大型组织中收集的不同的日志数据，以检测恶意软件感染和策略违反等恶意活动。Beehive利用企业网络的独特性去生成准确、可操作的信息。
- 我们基于超过6TB的日志数据对Beehive进行了测评，并且正确的识别出了可疑行为，而现有的最先进的安全工具和人力往往会忽视这些行为，无法发现。
- 据我们所知，我们对“大数据”安全分析挑战的探索是第一次，这些安全分析针对大量不同的、真实世界的日志数据。

 